---
title: "Vue 3 Composition API å®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼šå®Ÿè·µçš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ä»˜ã"
description: "Vue 3 Composition APIã®åŸºæœ¬ã‹ã‚‰å¿œç”¨ã¾ã§ã€å®Ÿè·µçš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã¨å…±ã«å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼"
pubDate: 2025-01-26
category: "Web Development"
tags: ["vue", "javascript", "frontend", "ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«", "composition-api"]
locale: "ja"
author: "Oiyo ãƒãƒ¼ãƒ "
featured: true
---

# Vue 3 Composition API å®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼šå®Ÿè·µçš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ä»˜ã

Vue 3ã®Composition APIã¯ã€ã‚ˆã‚ŠæŸ”è»Ÿã§å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ããŸã‚ã®å¼·åŠ›ãªæ©Ÿèƒ½ã§ã™ã€‚ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€åŸºæœ¬ã‹ã‚‰å¿œç”¨ã¾ã§ã‚’å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¨å…±ã«è§£èª¬ã—ã¾ã™ã€‚

## ğŸ¯ Composition APIã¨ã¯ï¼Ÿ

Composition APIã¯ã€Options APIã«ä»£ã‚ã‚‹æ–°ã—ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨˜è¿°æ–¹æ³•ã§ã™ã€‚TypeScriptã¨ã®ç›¸æ€§ãŒè‰¯ãã€ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨ãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚

### åŸºæœ¬çš„ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```vue
<script setup lang="ts">
import { ref, reactive, computed, onMounted } from 'vue'

// ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªçŠ¶æ…‹
const count = ref(0)
const user = reactive({
  name: 'å±±ç”°å¤ªéƒ',
  age: 25
})

// ç®—å‡ºãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
const doubleCount = computed(() => count.value * 2)

// ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯
onMounted(() => {
  console.log('ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒãƒã‚¦ãƒ³ãƒˆã•ã‚Œã¾ã—ãŸ')
})
</script>

<template>
  <div>
    <p>ã‚«ã‚¦ãƒ³ãƒˆ: {{ count }}</p>
    <p>2å€ã®ã‚«ã‚¦ãƒ³ãƒˆ: {{ doubleCount }}</p>
    <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼: {{ user.name }} ({{ user.age }}æ­³)</p>
  </div>
</template>
```

## ğŸ—ï¸ ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚·ã‚¹ãƒ†ãƒ ã®æ·±æ˜ã‚Š

### ref vs reactive

```vue
<script setup lang="ts">
// ref - ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å€¤ç”¨
const count = ref(0)
console.log(count.value) // 0

// reactive - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”¨
const state = reactive({
  items: [],
  loading: false
})
console.log(state.items) // ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

// computed - ç®—å‡ºãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
const evenNumbers = computed(() => 
  state.items.filter(item => item % 2 === 0)
)

// watch - å‰¯ä½œç”¨
watch(count, (newValue, oldValue) => {
  console.log(`ã‚«ã‚¦ãƒ³ãƒˆãŒ ${oldValue} ã‹ã‚‰ ${newValue} ã«å¤‰ã‚ã‚Šã¾ã—ãŸ`)
})

// watchEffect - å³æ™‚å®Ÿè¡Œ
watchEffect(() => {
  console.log(`ç¾åœ¨ã®ã‚«ã‚¦ãƒ³ãƒˆ: ${count.value}`)
})
</script>
```

## ğŸ§© ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã®ä½œæˆ

ãƒ­ã‚¸ãƒƒã‚¯ã‚’å†åˆ©ç”¨å¯èƒ½ãªéƒ¨å“ã¨ã—ã¦æŠ½å‡ºã§ãã¾ã™ï¼š

### useCounterã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«

```typescript
// composables/useCounter.ts
import { ref, computed } from 'vue'

export function useCounter(initialValue = 0) {
  const count = ref(initialValue)
  
  const doubleCount = computed(() => count.value * 2)
  
  function increment() {
    count.value++
  }
  
  function decrement() {
    count.value--
  }
  
  function reset() {
    count.value = initialValue
  }
  
  return {
    count: readonly(count),
    doubleCount,
    increment,
    decrement,
    reset
  }
}
```

```vue
<script setup lang="ts">
import { useCounter } from './composables/useCounter'

const { count, doubleCount, increment, decrement, reset } = useCounter(10)
</script>

<template>
  <div>
    <p>ã‚«ã‚¦ãƒ³ãƒˆ: {{ count }}</p>
    <p>2å€: {{ doubleCount }}</p>
    <button @click="increment">+1</button>
    <button @click="decrement">-1</button>
    <button @click="reset">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>
</template>
```

### useAPIã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«

```typescript
// composables/useAPI.ts
import { ref } from 'vue'

export function useAPI<T>(url: string) {
  const data = ref<T | null>(null)
  const error = ref<string | null>(null)
  const loading = ref(false)

  async function fetch() {
    loading.value = true
    error.value = null
    
    try {
      const response = await fetch(url)
      data.value = await response.json()
    } catch (err) {
      error.value = err instanceof Error ? err.message : 'ä¸æ˜ãªã‚¨ãƒ©ãƒ¼'
    } finally {
      loading.value = false
    }
  }

  return {
    data: readonly(data),
    error: readonly(error),
    loading: readonly(loading),
    fetch
  }
}
```

## ğŸ”„ çŠ¶æ…‹ç®¡ç†ã®é«˜åº¦ãªãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

```vue
<script setup lang="ts">
interface Transaction {
  id: string
  description: string
  amount: number
  category: string
  date: Date
}

const transactions = ref<Transaction[]>([])
const balance = computed(() => 
  transactions.value.reduce((sum, tx) => sum + tx.amount, 0)
)

const filter = reactive({
  category: 'all',
  dateRange: 'all'
})

const filteredTransactions = computed(() => {
  return transactions.value.filter(tx => {
    if (filter.category !== 'all' && tx.category !== filter.category) {
      return false
    }
    // æ—¥ä»˜ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ãƒ­ã‚¸ãƒƒã‚¯
    return true
  })
})

function addTransaction(transaction: Omit<Transaction, 'id'>) {
  const newTransaction: Transaction = {
    ...transaction,
    id: Date.now().toString(),
    date: new Date()
  }
  transactions.value.push(newTransaction)
}

function removeTransaction(id: string) {
  const index = transactions.value.findIndex(tx => tx.id === id)
  if (index > -1) {
    transactions.value.splice(index, 1)
  }
}
</script>
```

## ğŸ¨ ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³

### å‹•çš„ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

```vue
<script setup lang="ts">
import { ref, computed } from 'vue'

const isDark = ref(false)

const theme = computed(() => ({
  backgroundColor: isDark.value ? '#1a1a1a' : '#ffffff',
  color: isDark.value ? '#ffffff' : '#1a1a1a'
}))

function toggleTheme() {
  isDark.value = !isDark.value
}
</script>

<template>
  <div :style="theme" class="app">
    <button @click="toggleTheme">
      {{ isDark ? 'â˜€ï¸ ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰' : 'ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰' }}
    </button>
  </div>
</template>

<style scoped>
.app {
  transition: all 0.3s ease;
  padding: 20px;
  border-radius: 8px;
  min-height: 100vh;
}

button {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: transform 0.2s;
}

button:hover {
  transform: scale(1.05);
}
</style>
```

## ğŸ¯ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### é…å»¶èª­ã¿ã¨ã‚¹ãƒ­ãƒƒãƒˆ

```vue
<script setup lang="ts">
const heavyComponent = shallowRef(null)
const showHeavy = ref(false)

async function loadHeavyComponent() {
  if (!heavyComponent.value) {
    const module = await import('./HeavyComponent.vue')
    heavyComponent.value = module.default
  }
  showHeavy.value = true
}
</script>

<template>
  <div>
    <button @click="loadHeavyComponent">
      é‡ã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€
    </button>
    
    <HeavyComponent v-if="showHeavy" />
  </div>
</template>
```

### ãƒ¡ãƒ¢åŒ–ã¨ä»®æƒ³åŒ–

```vue
<script setup lang="ts">
const searchTerm = ref('')
const items = ref(Array.from({ length: 1000 }, (_, i) => ({
  id: i,
  name: `ã‚¢ã‚¤ãƒ†ãƒ  ${i}`
})))

// é‡ã„è¨ˆç®—ã‚’ãƒ¡ãƒ¢åŒ–
const filteredItems = computed(() => {
  return items.value.filter(item => 
    item.name.toLowerCase().includes(searchTerm.value.toLowerCase())
  )
})

// ãƒªã‚¹ãƒˆã®ä»®æƒ³åŒ–
const visibleItems = ref([])
const itemHeight = 50
const containerHeight = 400

function updateVisibleItems(scrollTop: number) {
  const startIndex = Math.floor(scrollTop / itemHeight)
  const endIndex = Math.min(
    startIndex + Math.ceil(containerHeight / itemHeight) + 1,
    filteredItems.value.length
  )
  
  visibleItems.value = filteredItems.value.slice(startIndex, endIndex)
}
</script>

<template>
  <div class="virtual-list" @scroll="updateVisibleItems($event.target.scrollTop)">
    <div class="spacer" :style="{ height: filteredItems.length * itemHeight + 'px' }"></div>
    <div class="items" :style="{ transform: `translateY(${startIndex * itemHeight}px)` }">
      <div 
        v-for="item in visibleItems" 
        :key="item.id"
        class="list-item"
        :style="{ height: itemHeight + 'px' }"
      >
        {{ item.name }}
      </div>
    </div>
  </div>
</template>
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

```typescript
// tests/composables/useCounter.test.ts
import { describe, it, expect } from 'vitest'
import { useCounter } from '../../composables/useCounter'

describe('useCounter', () => {
  it('åˆæœŸå€¤ã‚’æ­£ã—ãè¨­å®šã™ã‚‹ã“ã¨', () => {
    const { count } = useCounter(5)
    expect(count.value).toBe(5)
  })

  it('ã‚«ã‚¦ãƒ³ãƒˆã‚’å¢—æ¸›ã§ãã‚‹ã“ã¨', () => {
    const { count, increment, decrement } = useCounter(0)
    
    increment()
    expect(count.value).toBe(1)
    
    decrement()
    expect(count.value).toBe(0)
  })

  it('ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ã“ã¨', () => {
    const { count, increment, reset } = useCounter(5)
    
    increment()
    increment()
    expect(count.value).toBe(7)
    
    reset()
    expect(count.value).toBe(5)
  })
})
```

## ğŸ“š ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

1. ** TypeScriptã‚’å¸¸ã«ä½¿ç”¨ã™ã‚‹**: å‹å®‰å…¨æ€§ã®ç¢ºä¿
2. ** ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã«åˆ†é›¢**: å†åˆ©ç”¨æ€§ã®å‘ä¸Š
3. ** é©åˆ‡ãªãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚’é¸æŠ**: ref vs reactive
4. ** ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è€ƒæ…®**: ãƒ¡ãƒ¢åŒ–ã€ä»®æƒ³åŒ–
5. ** ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…**: try-catchã€error boundaries

## ğŸ‰ ã¾ã¨ã‚

Vue 3 Composition APIã¯ã€ã‚ˆã‚Šç¾ä»£çš„ã§ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚åŸºæœ¬ã‚’ç†è§£ã—ã€ã‚³ãƒ³ãƒãƒ¼ã‚¶ãƒ–ãƒ«ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¯ãƒªãƒ¼ãƒ³ã§å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚

## ğŸ”— ã•ã‚‰ãªã‚‹å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹

- [Vue 3å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vuejs.org/)
- [Composition APIã‚¬ã‚¤ãƒ‰](https://vuejs.org/guide/extras/composition-api-faq.html)
- [Vue School](https://vueschool.io/)

Happy Vue.jsé–‹ç™º! ğŸš€